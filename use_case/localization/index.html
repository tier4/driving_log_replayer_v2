
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://tier4.github.io/driving_log_replayer_v2/use_case/localization/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../yabloc/">
      
      
        
          <link rel="alternate" href="./" hreflang="en">
        
          <link rel="alternate" href="../../ja/use_case/localization/" hreflang="ja">
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Evaluate NDT estimation - driving_log_replayer_v2 Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#evaluate-ndt-estimation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="driving_log_replayer_v2 Documentation" class="md-header__button md-logo" aria-label="driving_log_replayer_v2 Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            driving_log_replayer_v2 Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Evaluate NDT estimation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../ja/use_case/localization/" hreflang="ja" class="md-select__link">
              日本語
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/tier4/driving_log_replayer_v2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  driving_log_replayer_v2 Documentation

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../quick_start/installation/" class="md-tabs__link">
          
  
  
    
  
  Quick start

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../trouble_shooting/" class="md-tabs__link">
          
  
  
    
  
  Trouble shooting

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../overview/" class="md-tabs__link">
          
  
  
    
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../scenario_format/" class="md-tabs__link">
          
  
  
    
  
  Scenario format

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../result_format/" class="md-tabs__link">
          
  
  
    
  
  Result format

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Use case

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../analyzer/" class="md-tabs__link">
          
  
  
    
  
  Analyzer

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="driving_log_replayer_v2 Documentation" class="md-nav__button md-logo" aria-label="driving_log_replayer_v2 Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    driving_log_replayer_v2 Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tier4/driving_log_replayer_v2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    driving_log_replayer_v2 Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Quick start
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Quick start
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick_start/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick_start/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick_start/run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run driving_log_replayer_v2 evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../trouble_shooting/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Trouble shooting
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Trouble shooting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../overview/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Command
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../scenario_format/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Scenario format
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Scenario format
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../result_format/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Result format
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Result format
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Use case
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Use case
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Evaluate NDT estimation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate NDT estimation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulation-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation Details
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scenario-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scenario Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments-passed-to-logging_simulatorlaunch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Arguments passed to logging_simulator.launch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topic-to-be-included-in-the-input-rosbag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Topic to be included in the input rosbag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topics-that-must-not-be-included-in-the-input-rosbag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Topics that must not be included in the input rosbag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#localization_evaluator_node" class="md-nav__link">
    <span class="md-ellipsis">
      
        localization_evaluator_node
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluation-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evaluation details
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Evaluation details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ndt-availability" class="md-nav__link">
    <span class="md-ellipsis">
      
        NDT Availability
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndt-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        NDT Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndt-reliability" class="md-nav__link">
    <span class="md-ellipsis">
      
        NDT Reliability
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difference-from-the-reference-trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Difference from the reference trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-rate-of-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error rate of diagnostics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#risefall-timing-of-the-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rise/fall timing of the diagnostics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluation-result-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evaluation Result Format
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../yabloc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate YabLoc estimation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eagleye/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate Eagleye estimation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ar_tag_based_localizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate ArTagBasedLocalizer estimation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../obstacle_segmentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate point cloud generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perception/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate perception
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance_diag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate LiDAR diagnostics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../annotationless_perception/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate Annotationless Perception
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../traffic_light/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate perception(traffic light)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perception_2d/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate perception(Camera)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../planning_control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate Planning Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diagnostics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate Diagnostics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ground_segmentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate Ground Segmentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../all_components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate All Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../analyzer/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Analyzer
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Analyzer
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulation-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation Details
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scenario-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scenario Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments-passed-to-logging_simulatorlaunch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Arguments passed to logging_simulator.launch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topic-to-be-included-in-the-input-rosbag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Topic to be included in the input rosbag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topics-that-must-not-be-included-in-the-input-rosbag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Topics that must not be included in the input rosbag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#localization_evaluator_node" class="md-nav__link">
    <span class="md-ellipsis">
      
        localization_evaluator_node
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluation-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evaluation details
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Evaluation details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ndt-availability" class="md-nav__link">
    <span class="md-ellipsis">
      
        NDT Availability
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndt-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        NDT Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndt-reliability" class="md-nav__link">
    <span class="md-ellipsis">
      
        NDT Reliability
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difference-from-the-reference-trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Difference from the reference trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-rate-of-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error rate of diagnostics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#risefall-timing-of-the-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rise/fall timing of the diagnostics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluation-result-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evaluation Result Format
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="evaluate-ndt-estimation">Evaluate NDT estimation<a class="headerlink" href="#evaluate-ndt-estimation" title="Permanent link">#</a></h1>
<p>Use case <code>localization</code> will evaluate the performance of NDT localization in Autoware.
Driving Log Replayer runs the <code>logging_simulator</code> of Autoware to replay the scenario, and evaluation will run during and after the simulation.
This pages explains how the simulation and the evaluation works for this use case.</p>
<h2 id="simulation-details">Simulation Details<a class="headerlink" href="#simulation-details" title="Permanent link">#</a></h2>
<p>This section explains the details and requirements to run the simulation.</p>
<h3 id="scenario-format">Scenario Format<a class="headerlink" href="#scenario-format" title="Permanent link">#</a></h3>
<p>See <a href="https://github.com/tier4/driving_log_replayer_v2/blob/develop/sample/localization/scenario.yaml">the sample scenario file</a>.</p>
<h3 id="arguments-passed-to-logging_simulatorlaunch">Arguments passed to logging_simulator.launch<a class="headerlink" href="#arguments-passed-to-logging_simulatorlaunch" title="Permanent link">#</a></h3>
<ul>
<li>perception: false</li>
<li>planning: false</li>
<li>control: false</li>
<li>pose_source: ndt</li>
<li>twist_source: gyro_odom</li>
</ul>
<h3 id="topic-to-be-included-in-the-input-rosbag">Topic to be included in the input rosbag<a class="headerlink" href="#topic-to-be-included-in-the-input-rosbag" title="Permanent link">#</a></h3>
<p>The input rosbag requires topics to function the localization component of Autoware.</p>
<p>If you use CAN data from the ECU, you will need the following topics in your rosbag.</p>
<table>
<thead>
<tr>
<th>Topic name</th>
<th>Data type</th>
</tr>
</thead>
<tbody>
<tr>
<td>/pacmod/from_can_bus</td>
<td>can_msgs/msg/Frame</td>
</tr>
<tr>
<td>/sensing/gnss/ublox/fix_velocity</td>
<td>geometry_msgs/msg/TwistWithCovarianceStamped</td>
</tr>
<tr>
<td>/sensing/gnss/ublox/nav_sat_fix</td>
<td>sensor_msgs/msg/NavSatFix</td>
</tr>
<tr>
<td>/sensing/gnss/ublox/navpvt</td>
<td>ublox_msgs/msg/NavPVT</td>
</tr>
<tr>
<td>/sensing/imu/tamagawa/imu_raw</td>
<td>sensor_msgs/msg/Imu</td>
</tr>
<tr>
<td>/sensing/lidar/*/velodyne_packets</td>
<td>velodyne_msgs/VelodyneScan</td>
</tr>
</tbody>
</table>
<p>Or, you can use vehicle topics instead of CAN data.</p>
<table>
<thead>
<tr>
<th>Topic name</th>
<th>Data type</th>
</tr>
</thead>
<tbody>
<tr>
<td>/sensing/gnss/ublox/fix_velocity</td>
<td>geometry_msgs/msg/TwistWithCovarianceStamped</td>
</tr>
<tr>
<td>/sensing/gnss/ublox/nav_sat_fix</td>
<td>sensor_msgs/msg/NavSatFix</td>
</tr>
<tr>
<td>/sensing/gnss/ublox/navpvt</td>
<td>ublox_msgs/msg/NavPVT</td>
</tr>
<tr>
<td>/sensing/imu/tamagawa/imu_raw</td>
<td>sensor_msgs/msg/Imu</td>
</tr>
<tr>
<td>/sensing/lidar/*/velodyne_packets</td>
<td>velodyne_msgs/VelodyneScan</td>
</tr>
<tr>
<td>/vehicle/status/control_mode</td>
<td>autoware_vehicle_msgs/msg/ControlModeReport</td>
</tr>
<tr>
<td>/vehicle/status/gear_status</td>
<td>autoware_vehicle_msgs/msg/GearReport</td>
</tr>
<tr>
<td>/vehicle/status/steering_status</td>
<td>autoware_vehicle_msgs/SteeringReport</td>
</tr>
<tr>
<td>/vehicle/status/turn_indicators_status</td>
<td>autoware_vehicle_msgs/msg/TurnIndicatorsReport</td>
</tr>
<tr>
<td>/vehicle/status/velocity_status</td>
<td>autoware_vehicle_msgs/msg/VelocityReport</td>
</tr>
</tbody>
</table>
<h3 id="topics-that-must-not-be-included-in-the-input-rosbag">Topics that must not be included in the input rosbag<a class="headerlink" href="#topics-that-must-not-be-included-in-the-input-rosbag" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>Topic name</th>
<th>Data type</th>
</tr>
</thead>
<tbody>
<tr>
<td>/clock</td>
<td>rosgraph_msgs/msg/Clock</td>
</tr>
</tbody>
</table>
<p>The clock is output by the --clock option of ros2 bag play, so if it is recorded in the bag itself, it outputs twice so it should not be included in the bag.</p>
<h3 id="localization_evaluator_node">localization_evaluator_node<a class="headerlink" href="#localization_evaluator_node" title="Permanent link">#</a></h3>
<p>Driving Log Replayer also launches a <code>localization_evaluator_node</code> with the <code>logging_simulator</code> to collect data for the evaluation.</p>
<p>The <code>localization_evaluator_node</code> subscribes the following topics.</p>
<table>
<thead>
<tr>
<th>Topic name</th>
<th>Data type</th>
</tr>
</thead>
<tbody>
<tr>
<td>/diagnostics</td>
<td>diagnostic_msgs::msg::DiagnosticArray</td>
</tr>
<tr>
<td>/localization/pose_estimator/transform_probability</td>
<td>autoware_internal_debug_msgs::msg::Float32Stamped</td>
</tr>
<tr>
<td>/localization/pose_estimator/nearest_voxel_transformation_likelihood</td>
<td>autoware_internal_debug_msgs::msg::Float32Stamped</td>
</tr>
<tr>
<td>/localization/pose_estimator/initial_to_result_relative_pose</td>
<td>geometry_msgs::msg::PoseStamped</td>
</tr>
<tr>
<td>/localization/pose_estimator/exe_time_ms</td>
<td>autoware_internal_debug_msgs::msg::Float32Stamped</td>
</tr>
<tr>
<td>/localization/pose_estimator/iteration_num</td>
<td>autoware_internal_debug_msgs::msg::Int32Stamped</td>
</tr>
<tr>
<td>/tf</td>
<td>tf2_msgs/msg/TFMessage</td>
</tr>
<tr>
<td>/localization/util/downsample/pointcloud</td>
<td>sensor_msgs::msg::PointCloud2</td>
</tr>
<tr>
<td>/localization/pose_estimator/points_aligned</td>
<td>sensor_msgs::msg::PointCloud2</td>
</tr>
</tbody>
</table>
<p>The <code>localization_evaluator_node</code> publishes the following topics.</p>
<table>
<thead>
<tr>
<th>Topic name</th>
<th>Data type</th>
</tr>
</thead>
<tbody>
<tr>
<td>/driving_log_replayer_v2/localization/lateral_distance</td>
<td>example_interfaces/msg/Float64</td>
</tr>
</tbody>
</table>
<p>The <code>localization_evaluator_node</code> calls the following services.</p>
<table>
<thead>
<tr>
<th>Service name</th>
<th>Data type</th>
</tr>
</thead>
<tbody>
<tr>
<td>/localization/initialize</td>
<td>autoware_internal_localization_msgs/srv/InitializeLocalization</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="evaluation-details">Evaluation details<a class="headerlink" href="#evaluation-details" title="Permanent link">#</a></h2>
<p>This use case can evaluate the following contents.</p>
<ul>
<li>NDT Availability</li>
<li>NDT Convergence</li>
<li>NDT Reliability</li>
<li>Difference from the reference trajectory (position, twist and acceleration)</li>
<li>Error rate of diagnostics</li>
<li>Rise/fall timing of the diagnostics</li>
</ul>
<p>When you launch Driving Log Replayer, the evaluation will start with the procedure below.</p>
<ol>
<li>Launch the <code>localization_evaluator_node</code>, <code>logging_simulator.launch</code> and <code>ros2 bag play</code> command</li>
<li>Autoware performs localization by the sensor data from the rosbag</li>
<li>The <code>localization_evaluator_node</code> evaluates the NDT Availability, Convergence and Reliability meanwhile and record the results into a file.</li>
<li>After the logging simulation is done, <a href="https://github.com/autowarefoundation/autoware_tools/tree/main/localization/autoware_localization_evaluation_scripts"><code>autoware_localization_evaluation_scripts</code></a> will start and evaluate the difference from the reference trajectory, error rate of diagnostics and the rise/fall timing of the diagnostics.</li>
<li>Summarize all results and then the program finishes automatically.</li>
</ol>
<p>If all the evaluation items turn to be Success, the entire evaluation is judged as Success.</p>
<p>The following sections explain the details of each evaluation item.</p>
<h3 id="ndt-availability">NDT Availability<a class="headerlink" href="#ndt-availability" title="Permanent link">#</a></h3>
<p>This evaluation basically starts for any kind of scenario, but it doesn't only if you defined a <code>availability</code> condition in the <code>Conditions</code> of the scenario and set its <code>enable</code> parameter as <code>false</code>.</p>
<p>Driving Log Replayer will evaluate the NDT Availability through <code>logging_simulator</code> by detecting these two cases.</p>
<ul>
<li>The <code>pointcloud_preprocessor</code> is failing due to such like runtime error. (Then the <code>ndt_scan_matcher</code> cannot subscribe LiDAR scan points.)</li>
<li>The <code>ndt_scan_matcher</code> itself is failing due to such like runtime error.</li>
</ul>
<p>This can be done by monitoring the following topic using an Autoware package Component State Monitor.</p>
<ul>
<li>/localization/pose_estimator/exe_time_ms</li>
</ul>
<p>We use <code>/localization/pose_estimator/exe_time_ms</code> since this topic is being published constantly. For example, <code>/localization/pose_estimator/pose</code> will not be published when the NVTL or TP is lower than the score threshold and does not suit this purpose.</p>
<p>This evaluation is judged as Success if <code>/localization/pose_estimator/exe_time_ms</code> is alive until the end of the <code>logging_simulator</code>, Fail if not.</p>
<h3 id="ndt-convergence">NDT Convergence<a class="headerlink" href="#ndt-convergence" title="Permanent link">#</a></h3>
<p>This evaluation starts if a <code>Convergence</code> condition is defined in the <code>Conditions</code> of the scenario.</p>
<div class="highlight"><pre><span></span><code><span class="nt">Evaluation</span><span class="p">:</span>
<span class="w">  </span><span class="nt">Conditions</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Convergence</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AllowableDistance</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span><span class="w"> </span><span class="c1"># Lateral distance to be considered convergence</span>
<span class="w">      </span><span class="nt">AllowableExeTimeMs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100.0</span><span class="w"> </span><span class="c1"># If the NDT computation time is less than or equal to this value, it is considered successful.</span>
<span class="w">      </span><span class="nt">AllowableIterationNum</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span><span class="w"> </span><span class="c1"># If the number of NDT calculations is less than or equal to this value, it is considered a success.</span>
<span class="w">      </span><span class="nt">PassRate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">95.0</span><span class="w"> </span><span class="c1"># How much (%) of the evaluation attempts are considered successful.</span>
</code></pre></div>
<p>This evaluation monitors these three topics through the <code>logging_simulator</code>.</p>
<table>
<thead>
<tr>
<th>Topic name</th>
<th>Success condition</th>
</tr>
</thead>
<tbody>
<tr>
<td>/localization/pose_estimator/initial_to_result_relative_pose</td>
<td>value of lateral factor &lt;= AllowableDistance</td>
</tr>
<tr>
<td>/localization/pose_estimator/exe_time_ms</td>
<td>value &lt;= AllowableExeTimeMs</td>
</tr>
<tr>
<td>/localization/pose_estimator/iteration_num</td>
<td>value &lt;= AllowableIterationNum</td>
</tr>
</tbody>
</table>
<p>If all three conditions have been passed, the NDT will be marked as converged for that time frame. If the rate of convergence is equal or larger than the <code>PassRate</code>, this evaluation is judged as Success.</p>
<h3 id="ndt-reliability">NDT Reliability<a class="headerlink" href="#ndt-reliability" title="Permanent link">#</a></h3>
<p>This evaluation starts if a <code>Reliability</code> condition is defined in the <code>Conditions</code> of the scenario.</p>
<div class="highlight"><pre><span></span><code><span class="nt">Evaluation</span><span class="p">:</span>
<span class="w">  </span><span class="nt">Conditions</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Reliability</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NVTL</span><span class="w"> </span><span class="c1"># NVTL or TP which method to use for evaluation</span>
<span class="w">      </span><span class="nt">AllowableLikelihood</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.3</span><span class="w"> </span><span class="c1"># If above this value, the localization reliability value is considered normal.</span>
<span class="w">      </span><span class="nt">NGCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w"> </span><span class="c1"># If the reliability value is lower than the threshold value for more than this number in the sequence. the evaluation is considered to have failed.</span>
</code></pre></div>
<p>This evaluation monitors the topic selected in the scenario during the <code>logging_simulator</code>.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Topic Name</th>
<th>Success Condition</th>
</tr>
</thead>
<tbody>
<tr>
<td>TP</td>
<td>/localization/pose_estimator/transform_probability</td>
<td>value &gt;= AllowableLikelihood</td>
</tr>
<tr>
<td>NVTL</td>
<td>/localization/pose_estimator/nearest_voxel_transformation_likelihood</td>
<td>value &gt;= AllowableLikelihood</td>
</tr>
</tbody>
</table>
<p>If the value of the topic is equal or larger than the <code>AllowableLikelihood</code>, the NDT is assumed to be reliable. If the TP or NVTL is below <code>AllowableLikelihood</code> for a consecutive <code>NGCount</code> times in the simulation, the evaluation is judged as Fail, if not Success.</p>
<h3 id="difference-from-the-reference-trajectory">Difference from the reference trajectory<a class="headerlink" href="#difference-from-the-reference-trajectory" title="Permanent link">#</a></h3>
<p>This evaluation basically starts for any kind of scenario.</p>
<p>After <code>logging_simulator</code> is done, the position, twist, and acceleration difference from the reference trajectory will be evaluated. See the actual implementation of <a href="https://github.com/autowarefoundation/autoware_tools/tree/main/localization/autoware_localization_evaluation_scripts"><code>autoware_localization_evaluation_scripts</code></a> for details of such like the definition of the difference.</p>
<p>The difference of the following factors will be evaluated</p>
<ul>
<li>Position</li>
<li>Orientation</li>
<li>Linear Velocity</li>
<li>Angular Velocity</li>
<li>Linear Acceleration</li>
</ul>
<p>You can choose which factor to evaluate or not by defining a <code>OverallCriteriaMask</code> in the scenario file and set true or false to <code>mean_relative_*</code>. If <code>OverallCriteriaMask</code> is not set in the scenario, the evaluator will set all factors to true by default. When all if the factors have small difference the evaluation is judged as Success, and Fail if not.</p>
<div class="highlight"><pre><span></span><code><span class="nt">Evaluation</span><span class="p">:</span>
<span class="w">  </span><span class="nt">Conditions</span><span class="p">:</span>
<span class="w">    </span><span class="nt">OverallCriteriaMask</span><span class="p">:</span><span class="w"> </span><span class="c1"># Toggle the mask below to perform or not to perform evaluation of the according criteria. The evaluator will automatically set all to `true` if this block is not defined.</span>
<span class="w">      </span><span class="nt">mean_relative_position</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">mean_relative_angle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">mean_relative_linear_velocity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">mean_relative_angular_velocity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">mean_relative_acceleration</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">diagnostics_not_ok_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h3 id="error-rate-of-diagnostics">Error rate of diagnostics<a class="headerlink" href="#error-rate-of-diagnostics" title="Permanent link">#</a></h3>
<p>This evaluation basically starts for any kind of scenario.</p>
<p>After the <code>logging_simulator</code> is done <code>autoware_localization_evaluation_scripts</code> evaluates whether localization related diagnostics (listed below) are not publishing errors with a high rate.</p>
<ul>
<li>ndt_scan_matcher: scan_matching_status</li>
<li>localization: ekf_localizer</li>
<li>localization_error_monitor: ellipse_error_status</li>
<li>localization: pose_instability_detector</li>
</ul>
<p>See the actual implementation of <a href="https://github.com/autowarefoundation/autoware_tools/tree/main/localization/autoware_localization_evaluation_scripts"><code>autoware_localization_evaluation_scripts</code></a> for details.</p>
<p>If the error rate is small enough for all diagnostics, the evaluation is judged as Success, and Fail if not.</p>
<p>You can disable the evaluation of this item by making the <code>diagnostics_not_ok_rate</code> in the <code>OverallCriteriaMask</code> false. If <code>OverallCriteriaMask</code> is not set in the scenario, the evaluator will set it to true by default.</p>
<div class="highlight"><pre><span></span><code><span class="nt">Evaluation</span><span class="p">:</span>
<span class="w">  </span><span class="nt">Conditions</span><span class="p">:</span>
<span class="w">    </span><span class="nt">OverallCriteriaMask</span><span class="p">:</span><span class="w"> </span><span class="c1"># Toggle the mask below to perform or not to perform evaluation of the according criteria. The evaluator will automatically set all to `true` if this block is not defined.</span>
<span class="w">      </span><span class="nt">mean_relative_position</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">mean_relative_angle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">mean_relative_linear_velocity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">mean_relative_angular_velocity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">mean_relative_acceleration</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">diagnostics_not_ok_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h3 id="risefall-timing-of-the-diagnostics">Rise/fall timing of the diagnostics<a class="headerlink" href="#risefall-timing-of-the-diagnostics" title="Permanent link">#</a></h3>
<p>This evaluation starts if a <code>DiagnosticsFlagCheck</code> condition is defined in the <code>Conditions</code> of the scenario.</p>
<div class="highlight"><pre><span></span><code><span class="nt">Evaluation</span><span class="p">:</span>
<span class="w">  </span><span class="nt">Conditions</span><span class="p">:</span>
<span class="w">    </span><span class="nt">DiagnosticsFlagCheck</span><span class="p">:</span>
<span class="w">      </span><span class="nt">pose_is_passed_delay_gate</span><span class="p">:</span><span class="w"> </span><span class="c1"># name of the diagnostics to check</span>
<span class="w">        </span><span class="nt">flag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rise</span><span class="w"> </span><span class="c1"># which flag to detect (`rise` or `fall`)</span>
<span class="w">        </span><span class="nt">at_sec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">113</span><span class="w"> </span><span class="c1"># The `sec` part of the expected time to rise/fall</span>
<span class="w">        </span><span class="nt">at_nanosec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">750000000</span><span class="w"> </span><span class="c1"># The `nanosec` part of the expected time to rise/fall</span>
<span class="w">      </span><span class="nt">pose_no_update_count</span><span class="p">:</span>
<span class="w">        </span><span class="nt">flag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rise</span>
<span class="w">        </span><span class="nt">at_sec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">117</span>
<span class="w">        </span><span class="nt">at_nanosec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">900000000</span>
</code></pre></div>
<p>After the <code>logging_simulator</code> is done <code>autoware_localization_evaluation_scripts</code> evaluates whether localization related diagnostics rise or fall at an expected timing. See the actual implementation of <a href="https://github.com/autowarefoundation/autoware_tools/tree/main/localization/autoware_localization_evaluation_scripts"><code>autoware_localization_evaluation_scripts</code></a> for details.</p>
<p>If all the specified diagnostics have risen/fallen within +/- 0.2 seconds of the expected time (defined by <code>at_sec</code> and <code>at_nanosec</code>), the evaluation is judged as Success, and Fail if not. Also if the flag has risen/fallen much earlier than expected, the evaluation is judged as Fail.</p>
<h3 id="evaluation-result-format">Evaluation Result Format<a class="headerlink" href="#evaluation-result-format" title="Permanent link">#</a></h3>
<p>See <a href="https://github.com/tier4/driving_log_replayer_v2/blob/develop/sample/localization/result.json">the sample file</a>.</p>
<p>For NDT Availability, Convergence and Reliability you can have the following result frames</p>
<p>Availability Result</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Availability&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;Total&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Success or Fail&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;Frame&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Success, Fail, or Warn&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Convergence Result</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Convergence&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;Total&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Success or Fail&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;Frame&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Success or Fail&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;LateralDistance&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initial_to_result_relative_pose.pose.position.y&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;HorizontalDistance&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initial_to_result_relative_pose.pose.positionの水平距離。参考値&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;ExeTimeMs&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ndtの計算にかかった時間&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;IterationNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ndtの再計算回数&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Reliability Result</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Reliability&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;Total&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Success or Fail&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;Frame&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Success or Fail&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;stamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;sec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stampの秒&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;nanosec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stampのnano秒&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NVTL or TPの値&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;Reference&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;stamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;sec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stampの秒&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;nanosec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stampのnano秒&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;評価に使用しなかった尤度。参考値。ValueがNVTLならTPが入る&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>For the difference from the reference trajectory, Error rate of diagnostics, and Rise/fall timing of the diagnostics, all results will be summarized in the bottom the result.json file.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Summary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Failed: Convergence (Fail): 570 / 632 -&gt; 90.19%, Reliability (Fail): NVTL Sequential NG Count: 10 (Total Test: 632, Average: 2.46835, StdDev: 0.16043), NDT Availability (Success): NDT available, mean_position_norm=0.166 [m]|mean_angle_norm=0.032 [deg]|mean_linear_velocity_norm=0.003 [m/s]|mean_angular_velocity_norm=0.001 [rad/s]|localization__ekf_localizer 13.447 [%] is too large.|localization__pose_instability_detector 0.000 [%]|localization_error_monitor__ellipse_error_status 13.447 [%] is too large.|ndt_scan_matcher__scan_matching_status 57.177 [%] is too large.|Diagnostics flag &#39;pose_is_passed_delay_gate&#39; OK.|Diagnostics flag &#39;pose_no_update_count&#39; OK.&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Evaluation Use Cases">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Evaluation Use Cases
              </div>
            </div>
          </a>
        
        
          
          <a href="../yabloc/" class="md-footer__link md-footer__link--next" aria-label="Next: Evaluate YabLoc estimation">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Evaluate YabLoc estimation
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 TIER IV Inc.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.expand", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>